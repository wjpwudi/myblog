<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="清风煮酒">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://evan.beee.top" crossorigin>
    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://yonina.space/2023/04/03/redis/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="1.redis简介Redis是什么？Redis（Remote Dictionary Server )，即远程字典服务 。是一个开源的使用ANSI C语言编写、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。 redis会周期性的把更新的数据写入磁盘或者把修改操作写入追加的记录文件，并且在此基础上实现了master-slave(主从)同步。免费和开源！是当下">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis">
<meta property="og:url" content="http://yonina.space/2023/04/03/Redis/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="1.redis简介Redis是什么？Redis（Remote Dictionary Server )，即远程字典服务 。是一个开源的使用ANSI C语言编写、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。 redis会周期性的把更新的数据写入磁盘或者把修改操作写入追加的记录文件，并且在此基础上实现了master-slave(主从)同步。免费和开源！是当下">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230404091815418.png">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230404091823696.png">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230404092031348.png">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230404092057348.png">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230406151914036.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/6223e017b59d4b3491467bddd8bf7d0b.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/5c9aff7af7694fa6aa3a121338de93e1.png">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230406172300693.png">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230406172317265.png">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230406193042083.png">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230406193220488.png">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230723205520677.png">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230727100757088.png">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230727100833116.png">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230727101206453.png">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230727110954814.png">
<meta property="og:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230801142317572.png">
<meta property="article:published_time" content="2023-04-03T12:09:56.839Z">
<meta property="article:modified_time" content="2023-08-24T08:07:09.862Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Redis">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="d:\%E6%BA%90%E7%A0%81\%E7%AC%94%E8%AE%B0\images\image-20230404091815418.png">
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/lm.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/lm.png">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/lm.png">
    <!--- Page Info-->
    
    <title>
        
            Redis -
        
        清风煮酒
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/assets/fonts.css">

    <!--- Font Part-->
    
    
    
    

    <!--- Inject Part-->
    
    <script id="hexo-configurations">
    let Global = window.Global || {};
    Global.hexo_config = {"hostname":"yonina.space","root":"/","language":"en"};
    Global.theme_config = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[""]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":true,"lazyload":true,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":true,"percentage":true},"busuanzi_counter":{"enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"pjax":true,"open_graph":true},"home_banner":{"enable":true,"image":{"light":"https://i.hd-r.cn/18a445cb91f22f6086a9393f719fba17.jpg","dark":"https://i.hd-r.cn/18a445cb91f22f6086a9393f719fba17.jpg"},"title":"welcome to 子羽 and Yonina's Family","subtitle":{"text":["我坚信，失败后的第一个黎明，就是争取胜利的新开始.","忘掉失败，不过要牢记失败中的教训.","我怕输，所以我从不敢放弃.","奋斗吧，改变不了起点但可以改变终点.","不是井里没有水，而是挖的不够深。不是成功来得慢，而是努力的不够狠."],"hitokoto":{"enable":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null}},"style":"static"},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null}]},"mermaid":{"enable":false,"version":"9.3.0"}},"version":"2.1.2","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":30},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"分类":{"path":"/categories/","icon":"fa-solid fa-robot"},"标签":{"path":"/tags/","icon":"fa-duotone fa-book"},"友链":{"path":"/links/","icon":"fa-solid fa-link"},"关于":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/wjpwudi/blog"}}},"search":{"enable":false,"preload":true},"tags":{"Tags":{"icon":"fa-solid fa-tags","path":"/tags/"}},"categories":{"Categories":{"icon":"fa-solid fa-folder","path":"/categories/"}}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"links":null},"article_date_format":"auto","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}}};
    Global.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="main-content-container">

        <div class="main-content-header">
            <header class="navbar-container">
    
    <div class="navbar-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                清风煮酒
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        HOME
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/categories/"  >
                                    
                                        
                                            <i class="fa-solid fa-robot"></i>
                                        
                                        分类
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/tags/"  >
                                    
                                        
                                            <i class="fa-duotone fa-book"></i>
                                        
                                        标签
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/links/"  >
                                    
                                        
                                            <i class="fa-solid fa-link"></i>
                                        
                                        友链
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown" 
                                    href="#" onClick="return false;">
                                    
                                        
                                            <i class="fa-regular fa-user"></i>
                                        
                                        关于&nbsp;<i class="fa-solid fa-chevron-down"></i>
                                    
                                </a>
                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                    
                                        <li>
                                        <a href="/about">ME
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://github.com/wjpwudi/blog">GITHUB
                                        </a>
                                        </li>
                                    
                                    </ul>
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer">
        <ul class="drawer-navbar-list">
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                HOME
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/categories/"  >
                             
                                
                                    <i class="fa-solid fa-robot"></i>
                                
                                分类
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/tags/"  >
                             
                                
                                    <i class="fa-duotone fa-book"></i>
                                
                                标签
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/links/"  >
                             
                                
                                    <i class="fa-solid fa-link"></i>
                                
                                友链
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="has-dropdown" 
                        href="#" onClick="return false;">
                            
                                
                                    <i class="fa-regular fa-user"></i>
                                
                                关于&nbsp;<i class="fa-solid fa-chevron-down"></i>
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                              
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" href="/about">ME</a>
                            </li>
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" target="_blank" rel="noopener" href="https://github.com/wjpwudi/blog">GITHUB</a>
                            </li>
                        
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            
            
                <div class="article-title">
                    <h1 class="article-title-regular">Redis</h1>
                </div>
            
                
            

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="https://img2.baidu.com/it/u=3556369831,3766649660&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=499">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">清风煮酒</span>
                            
                                <span class="author-label"></span>
                            
                        </div>
                        <div class="meta-info">
                            <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2023-04-03 20:09:56</span>
        <span class="mobile">2023-04-03 20:09</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2023-08-24 16:07:09</span>
            <span class="mobile">2023-08-24 16:07</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/Redis/">Redis</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Redis/">Redis</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content markdown-body">
                <h3 id="1-redis简介"><a href="#1-redis简介" class="headerlink" title="1.redis简介"></a>1.redis简介</h3><h4 id="Redis是什么？"><a href="#Redis是什么？" class="headerlink" title="Redis是什么？"></a>Redis是什么？</h4><p>Redis（Remote Dictionary Server )，即远程字典服务 。<br>是一个开源的使用ANSI C语言编写、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。</p>
<p>redis会周期性的把更新的数据写入磁盘或者把修改操作写入追加的记录文件，并且在此基础上实现了master-slave(主从)同步。<br>免费和开源！是当下最热门的 NoSQL 技术之一，也被人们称之为结构化数据库。</p>
<ul>
<li>Redis是一个开源的key-value存储系统</li>
<li>支持存储的value类型相对更多，包括String，list，set，zset，hash</li>
<li>数据类型支持push&#x2F;pop、add&#x2F;remove 以及取交集并集和差集及更丰富的操作，而且这些操作都是原子性的</li>
<li>支持不同方式的排序</li>
<li>类似memcached，数据缓存内存中</li>
<li>不同：Redis会周期性的把数据写入硬盘或者把修改操作写入追加的记录文件</li>
<li>实现了master-slave（主从）同步</li>
</ul>
<h4 id="NoSQL"><a href="#NoSQL" class="headerlink" title="NoSQL"></a>NoSQL</h4><p>泛指非关系型的数据库。随着互联网web2.0网站的兴起，传统的关系数据库在处理web2.0网站，特别是超大规模和高并发的SNS类型的web2.0纯动态网站已经显得力不从心，出现了很多难以克服的问题，而非关系型的数据库则由于其本身的特点得到了非常迅速的发展。NoSQL数据库的产生就是为了解决大规模数据集合多重数据种类带来的挑战，特别是大数据应用难题</p>
<ul>
<li>不遵循SQL标准</li>
<li>不支持ACID（原子性，一致性，隔离性，持久性），但并不是不支持事务</li>
<li>远超于SQL的性能</li>
</ul>
<p>1.2.2 NoSQL使用场景</p>
<ul>
<li>数据高并发读写 （电商秒杀功能）</li>
<li>海量数据读写</li>
<li>对数据高可扩展性的</li>
</ul>
<h4 id="Redis能干嘛？"><a href="#Redis能干嘛？" class="headerlink" title="Redis能干嘛？"></a>Redis能干嘛？</h4><p>1、内存存储、持久化，内存中是断电即失、所以说持久化很重要（rdb、aof） 2、效率高，可以用于高速缓存<br>3、发布订阅系统<br>4、地图信息分析<br>5、计时器、计数器（浏览量！）<br>6、…</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230404091815418.png"
                      alt="image-20230404091815418"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230404091823696.png"
                      alt="image-20230404091823696"
                ></p>
<h4 id="Redis技术"><a href="#Redis技术" class="headerlink" title="Redis技术"></a>Redis技术</h4><h5 id="Redis使用单线程-多路IO复用技术"><a href="#Redis使用单线程-多路IO复用技术" class="headerlink" title="Redis使用单线程+多路IO复用技术"></a>Redis使用单线程+多路IO复用技术</h5><p>多路复用是指用一个线程来检查多个文件描述符（Socket）的就绪状态，比如调用select（select * 切换到 星号库）和poll函数，传入多个文件描述符，如果有一个文件描述符就绪，则返回，否则阻塞直至超时。得到就绪状态后进行真正的操作可以在同一个线程里执行，也可以启动线程执行</p>
<ul>
<li>串行：一个一个操作完成</li>
<li>多线程+锁</li>
<li>单线程+多路IO复用</li>
</ul>
<h3 id="redis的原子性"><a href="#redis的原子性" class="headerlink" title="redis的原子性"></a>redis的原子性</h3><p>所谓原子操作是指不会被线程调度机制打断的操作。这种操作一旦开始，就一直运行到结束，中间不会有任何的context switch（切换到另一个线程）。</p>
<ul>
<li>单线程和多线程的原子性</li>
</ul>
<p>（1）在单线程中，能够在单条指令中完成的操作都可以认为是“原子操作”，因为中断只能发生在指令之间。<br>（2）在多线程中，不能被其他进程（线程）打断的操作就叫原子操作。<br>Redis单命令的原子性只要得益于 Redis是单线程的。</p>
<p>案例：</p>
<p>java的多线程是否满足原子性？</p>
<p>在两个线程中分别进行i&#x3D;0;和100次i++,最后的值为多少?</p>
<p>是2~200，要满足原子性，最后的值确定为200。</p>
<h3 id="行式存储数据库"><a href="#行式存储数据库" class="headerlink" title="行式存储数据库"></a>行式存储数据库</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230404092031348.png"
                      alt="image-20230404092031348"
                ></p>
<h3 id="列式存储数据库"><a href="#列式存储数据库" class="headerlink" title="列式存储数据库"></a>列式存储数据库</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230404092057348.png"
                      alt="image-20230404092057348"
                ></p>
<p>图关系型数据库</p>
<p>主要应用：社会关系，公共交通网络，地图</p>
<p>redis-server</p>
<h2 id="五大基本数据"><a href="#五大基本数据" class="headerlink" title="五大基本数据"></a>五大基本数据</h2><p>Redis字符串(String)</p>
<p>Redis列表(List)<br>Redis集合(Set)</p>
<p>Redis哈希(Hash)</p>
<p>Redis有序集合Zset</p>
<h4 id="Redis键-Key"><a href="#Redis键-Key" class="headerlink" title="Redis键(Key)"></a>Redis键(Key)</h4><p>常用命令</p>
<p>keys *  	  #查看当前库所有key（匹配：keys *1）<br>exists key    #判断某个key是否存在<br>type key      #查看你的key是什么类型<br>del key  	  #删除指定的key的数据<br>unlink key    #根据value选择非阻塞删除</p>
<p>仅将keys从keyspace元数据中删除，真正的删除会在后续异步操作</p>
<p>expire key 10 #10秒钟：为给定的key设置过期时间<br>ttl key		  #查看还有多少秒过期，-1表示永不过期，-2表示已过期</p>
<p>select 		  #切换数据库<br>dbsize	      #查看当前数据库的key的数量<br>flushdb 	  #清空当前数据库<br>flushall 	  #通杀所有库</p>
<h4 id="3-1-字符串-Srting"><a href="#3-1-字符串-Srting" class="headerlink" title="3.1 字符串(Srting)"></a>3.1 字符串(Srting)</h4><h5 id="3-1-1简介"><a href="#3-1-1简介" class="headerlink" title="3.1.1简介"></a>3.1.1简介</h5><p>String是redis最基本的类型，可以理解成与Memcached一摸一样的类型，一个key对应一个value。<br>String类型是二进制安全的。意味着Redis的String可以包含任何数据。比如jpg图片或者序列化对象。<br>String类型是Redis最基本的数据类型，一个字符串value最多可以是512M。</p>
<h5 id="3-1-2-常用命令"><a href="#3-1-2-常用命令" class="headerlink" title="3.1.2 常用命令"></a>3.1.2 常用命令</h5><div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1.set &lt;key&gt;&lt;value&gt; <span class="params">#</span>添加键值对</span><br><span class="line">*NX:当数据库中key不存在时，可以将key-value添加数据库</span><br><span class="line">*XX:当数据库中key存在时，可以将key-value添加数据库，与NX参数互斥</span><br><span class="line">*EX:key的超时秒数</span><br><span class="line">*PX:key的超时毫秒数，与EX互斥</span><br><span class="line">2.get &lt;key&gt; <span class="params">#</span>查询对应键值</span><br><span class="line"></span><br><span class="line">3.append &lt;key&gt;&lt;value&gt; <span class="params">#</span>将给定的value追加到原值的末尾</span><br><span class="line"></span><br><span class="line">4.strlen &lt;key&gt; <span class="params">#</span>获得键值的长度</span><br><span class="line"></span><br><span class="line">5.setnx &lt;key&gt;&lt;value&gt; <span class="params">#</span>只有在key不存在时 设置key的值</span><br><span class="line"></span><br><span class="line">6.incr &lt;key&gt; <span class="params">#</span>将key中存储的数字值增1    <span class="params">#</span>只能对数字值操作，如果为空，新增值为1</span><br><span class="line">7.decr &lt;key&gt; <span class="params">#</span>减1</span><br><span class="line"></span><br><span class="line">8.incrby/decrby &lt;key&gt; &lt;步长&gt; <span class="params">#</span>增减数字值</span><br></pre></td></tr></table></figure></div>





<div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">mset &lt;key1&gt;&lt;value1&gt;&lt;key2&gt;&lt;value2&gt;...</span><br><span class="line"></span><br><span class="line">同时设置一个或者多个key-value对</span><br><span class="line"></span><br><span class="line">mget   同时获得多个value</span><br><span class="line"></span><br><span class="line">msetnx  </span><br><span class="line"></span><br><span class="line">同时设置一个或多个key-value对，当且仅当所有给定key都不在</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">原子性，有一个失败则都失败</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">getrange &lt;key&gt;&lt;start&gt;&lt;end&gt; </span><br><span class="line"></span><br><span class="line">获得值的范围，类似java中的substring，前包，后包</span><br><span class="line"></span><br><span class="line">setrange &lt;key&gt;&lt;起始位置&gt;&lt;value&gt;</span><br><span class="line"></span><br><span class="line">  用&lt;value&gt;覆写&lt;key&gt;所储存的字符串值，从&lt;起始位置&gt;开始（索引从0开始）</span><br><span class="line"></span><br><span class="line">setex &lt;key&gt;&lt;过期时间&gt;&lt;value&gt;  </span><br><span class="line"></span><br><span class="line">设置键值的同时，设置过期时间，单位秒</span><br><span class="line"></span><br><span class="line">getset&lt;key&gt;&lt;value&gt;  </span><br><span class="line"></span><br><span class="line">以新换旧，设置了新值的同时获得旧值</span><br></pre></td></tr></table></figure></div>



<h5 id="3-1-3-数据结构"><a href="#3-1-3-数据结构" class="headerlink" title="3.1.3 数据结构"></a>3.1.3 数据结构</h5><p>String的数据结构为简单动态字符串（Simple Dynamic String）。是可以修改的字符串，内部结构实现上类似于Java的ArrayList，采用预分配冗余空间的方式来减少内存的频繁分配。 </p>
<h4 id="3-2-列表（List）"><a href="#3-2-列表（List）" class="headerlink" title="3.2 列表（List）"></a>3.2 列表（List）</h4><h5 id="3-2-1-简介"><a href="#3-2-1-简介" class="headerlink" title="3.2.1 简介"></a>3.2.1 简介</h5><p>&#x3D;&#x3D;<strong>特点:单键多值</strong>&#x3D;&#x3D;</p>
<p>Redis列表是简单的字符串列表，按照插入顺序排序，可以添加一个元素到表的头部或者尾部。<br>它的底层实际是个&#x3D;&#x3D;双向链表&#x3D;&#x3D;，对两端的操作性能很高，通过索引下标的操作中间的结点性能会较差。</p>
<h6 id="3-2-2-常用命令"><a href="#3-2-2-常用命令" class="headerlink" title="3.2.2 常用命令"></a>3.2.2 常用命令</h6><div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">lpush/rpush &lt;key&gt;&lt;value1&gt;&lt;value2&gt;&lt;value3&gt;...</span><br><span class="line"><span class="params">#</span>从左边/右边插入值 </span><br><span class="line">lpop/rpop &lt;key&gt;</span><br><span class="line"><span class="params">#</span>从左边/右边吐出一个值。值在键在，值光键亡。</span><br><span class="line"></span><br><span class="line">rpoplpush &lt;key1&gt;&lt;key2&gt;</span><br><span class="line"><span class="params">#</span>从1列表右边吐出一个值，插到2列表左边</span><br><span class="line"></span><br><span class="line">lrange &lt;key&gt;&lt;start&gt;&lt;stop&gt;</span><br><span class="line"><span class="params">#</span>按照索引下标获得元素（从左到右）</span><br><span class="line"></span><br><span class="line">lrange mylist 0 -1</span><br><span class="line"><span class="params">#0</span>左边第一个，-1右边第一个，（0 -1表示获取所有）</span><br><span class="line">lindex &lt;key&gt;&lt;index&gt;</span><br><span class="line"><span class="params">#</span>按照索引下标获得元素（从左到右）</span><br><span class="line">llen &lt;key&gt;</span><br><span class="line"><span class="params">#</span>获得列表长度</span><br><span class="line"></span><br><span class="line">linsert &lt;key&gt; before &lt;value&gt;&lt;newvalue&gt;</span><br><span class="line"><span class="params">#</span>在value的前面插入new值</span><br><span class="line">lrem &lt;key&gt;&lt;n&gt;&lt;value&gt;</span><br><span class="line"><span class="params">#</span>从左边删除n个value（从左到右）</span><br><span class="line">lset&lt;key&gt;&lt;index&gt;&lt;value&gt;</span><br><span class="line"><span class="params">#</span>将列表下标为index的值替换成value</span><br></pre></td></tr></table></figure></div>

<h4 id="3-3-集合（Set）"><a href="#3-3-集合（Set）" class="headerlink" title="3.3 集合（Set）"></a>3.3 集合（Set）</h4><h5 id="3-3-1-简介"><a href="#3-3-1-简介" class="headerlink" title="3.3.1 简介"></a>3.3.1 简介</h5><p>Redis set对外提供的功能与list类似是一个列表的功能，特殊之处在于set是可以自动排重的，当你需要存储一个列表数据，又不希望出现重复数据时，set是一个很好的选择。并且set提供了判断某个成员是否在一个set集合内的重要接口，这个也是list所不能提供的。<br>Redis的Set是string类型的无序集合。它的底层是一个value为null的hash表，所以添加、删除、查找的复杂度都是O（1）。<br>一个算法，随着数据的增加，执行时间的长短，如果是1，数据增加，查找数据的时间不变。</p>
<p><strong>特点：不会重复，可快速查找、添加、删除</strong></p>
<div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">SADD : sadd key-name item [item ...]----------将一个或多个元素添加到集合里，并返回添加的元素数量（重复的元素不会被添加）</span><br><span class="line"></span><br><span class="line">SREM ： srem key-name  item [item ..]---------从一个集合里面移除一个或多个元素，并返回被移除的元素数量</span><br><span class="line"></span><br><span class="line">SISMEMBER :  sisimember key-name item -------检查元素item是否存在于集合key-name里</span><br><span class="line"></span><br><span class="line">SCARD : scard key-name --------------------------返回集合包含的元素数量</span><br><span class="line"></span><br><span class="line">SMEMBERS : smembers key-name ---------------返回集合包含的所有元素</span><br><span class="line"></span><br><span class="line">SRANDMEMBER : srandmember key-name [count] ---------------从集合里面随机返回一个或多个元素，当count为正数时，返回的元素不会重复，当count为负数时，返回的元素可能重复</span><br><span class="line"></span><br><span class="line">SPOP ： spop key-name ------------------------------随机移除集合中的一个元素，并返回被移除的元素</span><br><span class="line"></span><br><span class="line">SMOVE ： smove source-key dest-key item -------------------------如果集合source-key包含元素item,那么从集合source-key里面移除元素item,并将元素item添加到集合dest-key中：如果item被成功移除，那么命令返回1，否则返回0</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">（用于组合和处理多个集合的redis命令）</span><br><span class="line"></span><br><span class="line">SDIFF : sdiff key-name [key-name ...] ------------------返回那些存在于第一个集合，但不存在于其他集合中的元素（数学上的差集运算）</span><br><span class="line"></span><br><span class="line">SDIFFSTORE : sdiffstore dest-key key-name [key-name..] --------------将那些存在于第一个集合但并不存在其他集合中的元素存储到dest-key集合中</span><br><span class="line"></span><br><span class="line">SINTER ： sinter key-name [key-name ...] -----------------------------------返回那些同时存在所有集合中的元素（数学上的交集运算）</span><br><span class="line"></span><br><span class="line">SINTERSTORE : sinterstore dest-key key-name [key-name..] --------------将那些同时存在所有集合中的元素存储到dest-key集合中</span><br><span class="line"></span><br><span class="line">SUNION : sunion key-name [key-name..] ------------------------------------返回那些存在于任意一个集合中的元素（数学上的并集运算）</span><br><span class="line"></span><br><span class="line">SUNIONSTORE : sunionstore dest-key key-name [key-name..] --------------将那些存在于任意一个集合中的元素存储到dest-key集合中</span><br></pre></td></tr></table></figure></div>



<h4 id="3-4-哈希（Hash）"><a href="#3-4-哈希（Hash）" class="headerlink" title="3.4 哈希（Hash）"></a>3.4 哈希（Hash）</h4><h5 id="3-4-1-简介"><a href="#3-4-1-简介" class="headerlink" title="3.4.1 简介"></a>3.4.1 简介</h5><p>Redis hash是一个键值对集合;  </p>
<p>Hash 是一个 string 类型的 field（字段） 和 value（值） 的映射表，hash 特别适合用于存储对象。</p>
<p>类似于Java里面的Map&lt;String,Object&gt;</p>
<p>用户ID为查找的key，存储的value用户对象包含姓名，年龄，生日等信息，如果用普通的key&#x2F;value结构来存储.<br>主要有以下2种存储方式:</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230406151914036.png"
                      alt="image-20230406151914036"
                ></p>
<h5 id="3-4-2-常用命令"><a href="#3-4-2-常用命令" class="headerlink" title="3.4.2 常用命令"></a>3.4.2 常用命令</h5><div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">hset &lt;key&gt;&lt;field&gt;&lt;value&gt;</span><br><span class="line"><span class="params">#</span>给&lt;key&gt;集合中的 &lt;field&gt;键赋值&lt;value&gt;   //hset user:1001 id 1 hset user:1001 name zhangsan</span><br><span class="line">hget &lt;key1&gt;&lt;field&gt;</span><br><span class="line"><span class="params">#</span>从&lt;key1&gt;集合&lt;field&gt;取出 value</span><br><span class="line">hmset &lt;key1&gt;&lt;field1&gt;&lt;value1&gt;&lt;field2&gt;&lt;value2&gt;... </span><br><span class="line"><span class="params">#</span>批量设置hash的值 </span><br><span class="line">hexists&lt;key1&gt;&lt;field&gt;</span><br><span class="line"><span class="params">#</span>查看哈希表 key 中，给定域 field 是否存在。</span><br><span class="line">hkeys &lt;key&gt;</span><br><span class="line"><span class="params">#</span>列出该hash集合的所有field</span><br><span class="line">hvals &lt;key&gt;</span><br><span class="line"><span class="params">#</span>列出该hash集合的所有value</span><br><span class="line">hincrby &lt;key&gt;&lt;field&gt;&lt;increment&gt;</span><br><span class="line"><span class="params">#</span>为哈希表 key 中的域 field 的值加上增量 1 -1</span><br><span class="line">hsetnx &lt;key&gt;&lt;field&gt;&lt;value&gt;</span><br><span class="line"><span class="params">#</span>将哈希表 key 中的域 field 的值设置为 value ，当且仅当域 field 不存在 </span><br></pre></td></tr></table></figure></div>

<h5 id="3-4-3-数据结构"><a href="#3-4-3-数据结构" class="headerlink" title="3.4.3 数据结构"></a>3.4.3 数据结构</h5><p>Hash类型对应的数据结构是两种: ziplist（压缩列表),hashtable(哈希表)。当field-value长度较短且个数较少时，使用ziplist，否则使用hashtable。</p>
<h4 id="3-5-Redis有序集合Zset-sorted-set"><a href="#3-5-Redis有序集合Zset-sorted-set" class="headerlink" title="3.5 Redis有序集合Zset(sorted set)"></a>3.5 Redis有序集合Zset(sorted set)</h4><h5 id="3-5-1-简介"><a href="#3-5-1-简介" class="headerlink" title="3.5.1 简介"></a>3.5.1 简介</h5><p>Redis有序集合zset与普通集合set非常相似，是一个<strong>没有重复元素</strong>的字符串集合。<br>不同之处是有序集合的每个成员都关联了一个评分（score）,这个评分（score）被用来按照从最低分到最高分的方式排序集合中的成员。&#x3D;&#x3D;集合的成员是唯一的，但是评分可以是重复了 。&#x3D;&#x3D;<br>因为元素是有序的, 所以你也可以很快的根据评分（score）或者次序（position）来获取一个范围的元素。<br>访问有序集合的中间元素也是非常快的,因此你能够使用有序集合作为一个没有重复成员的智能列表。</p>
<h5 id="3-5-2-常用命令"><a href="#3-5-2-常用命令" class="headerlink" title="3.5.2 常用命令"></a>3.5.2 常用命令</h5><div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">zadd &lt;key&gt;&lt;score1&gt;&lt;value1&gt;&lt;score2&gt;&lt;value2&gt;…</span><br><span class="line"><span class="params">#</span>将一个或多个 member 元素及其 score 值加入到有序集 key 当中。</span><br><span class="line">zrange &lt;key&gt;&lt;start&gt;&lt;stop&gt; [WITHSCORES] </span><br><span class="line"><span class="params">#</span>返回有序集 key 中，下标在&lt;start&gt;&lt;stop&gt;之间的元素带WITHSCORES，可以让分数一</span><br><span class="line"><span class="params">#</span>起和值返回到结果集。</span><br><span class="line">zrangebyscore &lt;key&gt; min max [withscores] [limit offset count]</span><br><span class="line"><span class="params">#</span>返回有序集 key 中，所有 score 值介于 min 和 max 之间(包括等于 min 或 max)的成员。有序集成员按 score 值递增(从小到大)次序排列。</span><br><span class="line">zrevrangebyscore &lt;key&gt; max min [withscores] [limit offset count] </span><br><span class="line"><span class="params">#</span>同上，改为从大到小排列。</span><br><span class="line">zincrby &lt;key&gt;&lt;increment&gt;&lt;value&gt; </span><br><span class="line"><span class="params">#</span>为元素的score加上增量</span><br><span class="line">zrem &lt;key&gt;&lt;value&gt;</span><br><span class="line"><span class="params">#</span>删除该集合下，指定值的元素</span><br><span class="line">zcount &lt;key&gt;&lt;min&gt;&lt;max&gt;</span><br><span class="line"><span class="params">#</span>统计该集合，分数区间内的元素个数</span><br><span class="line">zrank &lt;key&gt;&lt;value&gt;</span><br><span class="line"><span class="params">#</span>返回该值在集合中的排名，从0开始。</span><br></pre></td></tr></table></figure></div>

<h5 id="3-5-3-数据结构"><a href="#3-5-3-数据结构" class="headerlink" title="3.5.3 数据结构"></a>3.5.3 数据结构</h5><p>SortedSet(zset)是Redis提供的一个非常特别的数据结构。</p>
<p>一方面它等价于Java的数据结构Map&lt;String，Double&gt;，可以给每一个元素value赋予一个权重score，另一方面它又类似于TreeSet，内部的元素会按照权重score进行排序，可以得到每个元素的名次，还可以通过score的范围来获取元素的列表。</p>
<p>zset底层使用了两个数据结构。</p>
<p>(1) hash , hash 的作用就是关联元素value和权重score，保障元素value的唯一性，可以通过元素value找到相应的score值。</p>
<p>(2)跳跃表，跳跃表的目的在于给元素value排序，根据score的范围获取元素列表。</p>
<h5 id="3-5-4-跳跃表（跳表）"><a href="#3-5-4-跳跃表（跳表）" class="headerlink" title="3.5.4 跳跃表（跳表）"></a>3.5.4 跳跃表（跳表）</h5><p>1、简介<br>有序集合在生活中比较常见，例如根据成绩对学生排名，根据得分对玩家排名等。对于有序集合的底层实现，可以用数组、平衡树、链表等。数组不便元素的插入、删除；平衡树或红黑树虽然效率高但结构复杂；链表查询需要遍历所有效率低。Redis采用的是跳跃表。跳跃表效率堪比红黑树，实现远比红黑树简单。<br>2、实例<br>对比有序链表和跳跃表，从链表中查询出51<br>（1） 有序链表<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://img-blog.csdnimg.cn/6223e017b59d4b3491467bddd8bf7d0b.png"
                      alt="img"
                ></p>
<p>(2)跳跃表<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://img-blog.csdnimg.cn/5c9aff7af7694fa6aa3a121338de93e1.png"
                      alt="img"
                ></p>
<p>可以发现使用跳跃表的遍历效率远远高于普通的有序链表</p>
<p>​                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </p>
<h4 id="4-配置文件介绍"><a href="#4-配置文件介绍" class="headerlink" title="4.配置文件介绍"></a>4.配置文件介绍</h4><p>[<a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45988641/article/details/118328708?ops_request_misc=%7B%22request_id%22:%22166720407016782428660717%22,%22scm%22:%2220140713.130102334..%22%7D&amp;request_id=166720407016782428660717&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-118328708-null-null.142%5Ev62%5Epc_search_tree,201%5Ev3%5Econtrol_1,213%5Ev1%5Econtrol&amp;utm_term=redis%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6&amp;spm=1018.2226.3001.4187%5D" >https://blog.csdn.net/qq_45988641/article/details/118328708?ops_request_misc=%7B%22request%5Fid%22%3A%22166720407016782428660717%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=166720407016782428660717&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-118328708-null-null.142%5Ev62%5Epc_search_tree,201%5Ev3%5Econtrol_1,213%5Ev1%5Econtrol&amp;utm_term=redis%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6&amp;spm=1018.2226.3001.4187] <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>: </p>
<h3 id="6-新数据类型"><a href="#6-新数据类型" class="headerlink" title="6.新数据类型"></a>6.新数据类型</h3><h4 id="6-1-Bitmaps"><a href="#6-1-Bitmaps" class="headerlink" title="6.1 Bitmaps"></a>6.1 Bitmaps</h4><h5 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h5><p>现代计算机用二进制（位） 作为信息的基础单位， 1个字节等于8位， 例如“abc”字符串是由3个字节组成， 但实际在计算机存储时将其用二进制表示， “abc”分别对应的ASCII码分别是97、 98、 99， 对应的二进制分别是01100001、 01100010和01100011，如下图<br><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230406172300693.png"
                      alt="image-20230406172300693"
                ></p>
<p>合理地使用操作位能够有效地提高内存使用率和开发效率。<br>Redis提供了Bitmaps这个“数据类型”可以实现对位的操作：<br>（1） Bitmaps本身不是一种数据类型， 实际上它就是字符串（key-value） ， 但是它可以对字符串的位进行操作。<br>（2） Bitmaps单独提供了一套命令， 所以在Redis中使用Bitmaps和使用字符串的方法不太相同。 可以把Bitmaps想象成一个以位为单位的数组， 数组的每个单元只能存储0和1， 数组的下标在Bitmaps中叫做偏移量。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230406172317265.png"
                      alt="image-20230406172317265"
                ></p>
<h5 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h5><h6 id="1、setbit"><a href="#1、setbit" class="headerlink" title="1、setbit"></a>1、setbit</h6><p>（1）格式</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setbit key <span class="keyword">offset</span> <span class="keyword">value</span></span><br></pre></td></tr></table></figure></div>

<p>setbit设置Bitmaps中某个偏移量的值（0或1）</p>
<p>*offset:偏移量从0开始</p>
<h6 id="2-getbit"><a href="#2-getbit" class="headerlink" title="2.getbit"></a>2.getbit</h6><div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getbit key <span class="keyword">offset</span></span><br></pre></td></tr></table></figure></div>

<p>例：getbit unique:users:20230406 8</p>
<p>获取键的第offset位的值（从0开始算）</p>
<h6 id="3、bitcount"><a href="#3、bitcount" class="headerlink" title="3、bitcount"></a>3、bitcount</h6><div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bitcount key [<span class="keyword">start</span> <span class="keyword">end</span>] </span><br></pre></td></tr></table></figure></div>

<p>统计字符串从start字节到end字节比特值为1的数量</p>
<h6 id="4、bitop"><a href="#4、bitop" class="headerlink" title="4、bitop"></a>4、bitop</h6><div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bitop  <span class="keyword">and</span>(<span class="keyword">or</span><span class="operator">/</span><span class="keyword">not</span><span class="operator">/</span>xor) <span class="operator">&lt;</span>destkey<span class="operator">&gt;</span> [key…]</span><br></pre></td></tr></table></figure></div>

<p>bitop是一个复合操作， 它可以做多个Bitmaps的and（交集） 、 or（并集） 、 not（非） 、 xor（异或） 操作并将结果保存在destkey中。</p>
<p>(2)实例<br>2020-11-04日访问网站的userid&#x3D;1,2,5,9。</p>
<p>setbit unique:users:20201104 1 1<br>setbit unique:users:20201104 2 1</p>
<p>setbit unique:users:20201104 5 1</p>
<p>setbit unique:users:20201104 9 1</p>
<p>2020-11-03日访问网站的userid&#x3D;0,1,4,9。</p>
<p>setbit unique:users:20201103 0 1<br>setbit unique:users:20201103 1 1</p>
<p>setbit unique:users:20201103 4 1</p>
<p>setbit unique:users:20201103 9 1</p>
<p>计算出两天都访问过网站的用户数量bitop and unique:users:and:20201104_03 unique:;users:20201103unique:users:20201104</p>
<h4 id="6-2-HyperLogLog"><a href="#6-2-HyperLogLog" class="headerlink" title="6.2 HyperLogLog"></a>6.2 HyperLogLog</h4><h5 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h5><p>在工作当中，我们经常会遇到与统计相关的功能需求，比如统计网站PV（PageView页面访问量）,可以使用Redis的incr、incrby轻松实现。<br>但像UV（UniqueVisitor，独立访客）、独立IP数、搜索记录数等需要去重和计数的问题如何解决？这种求集合中不重复元素个数的问题称为基数问题。<br>解决基数问题有很多种方案：<br>（1）数据存储在MySQL表中，使用distinct count计算不重复个数<br>（2）使用Redis提供的hash、set、bitmaps等数据结构来处理<br>以上的方案结果精确，但随着数据不断增加，导致占用空间越来越大，对于非常大的数据集是不切实际的。<br>能否能够降低一定的精度来平衡存储空间？</p>
<ul>
<li>Redis推出了HyperLogLog</li>
</ul>
<p>Redis HyperLogLog 是用来做基数统计的算法<br>优点是：</p>
<ul>
<li>在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定的、并且是很小的。</li>
</ul>
<p>在 Redis 里面，每个 HyperLogLog 键只需要花费 12 KB 内存，就可以计算接近 2^64 个不同元素的基数。这和计算基数时，元素越多耗费内存就越多的集合形成鲜明对比 。<br>但是，因为 HyperLogLog 只会根据输入元素来计算基数，而不会储存输入元素本身，所以 HyperLogLog 不能像集合那样，返回输入的各个元素。</p>
<p>什么是基数?<br>比如数据集 {1, 3, 5, 7, 5, 7, 8}， 那么这个数据集的基数集为 {1, 3, 5 ,7, 8}, 基数(不重复元素)为5。 基数估计就是在误差可接受的范围内，快速计算基数。</p>
<p>命令</p>
<h6 id="1、pfadd"><a href="#1、pfadd" class="headerlink" title="1、pfadd"></a>1、pfadd</h6><p> 添加指定元素到HyperLogLog 中</p>
<div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pfadd &lt;key&gt;&lt;element&gt; [element ...]  </span><br></pre></td></tr></table></figure></div>

<p>例： pfadd program “java”</p>
<h6 id="2、pfcount"><a href="#2、pfcount" class="headerlink" title="2、pfcount"></a>2、pfcount</h6><p>pfcount<key> [key …]计算HLL的近似基数，可以计算多个HLL，比如用HLL存储每天的UV，计算一周的UV可以使用7天的U合并计算即可</p>
<div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pfcount [key …] </span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230406193042083.png"
                      alt="image-20230406193042083"
                ></p>
<h6 id="3、pfmerge"><a href="#3、pfmerge" class="headerlink" title="3、pfmerge"></a>3、pfmerge</h6><div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pfmerge &lt;destkey&gt; &lt;sourcekey&gt; [sourcekey ...]  </span><br></pre></td></tr></table></figure></div>

<p>将一个或多个HLL合并后的结果存储在另一个HLL中，比如每月活跃用户可以使用每天的活跃用户来合并计算可得</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230406193220488.png"
                      alt="image-20230406193220488"
                ></p>
<h4 id="6-3-Geospatial"><a href="#6-3-Geospatial" class="headerlink" title="6.3.Geospatial"></a>6.3.Geospatial</h4><h5 id="简介-2"><a href="#简介-2" class="headerlink" title="简介"></a>简介</h5><p>Redis 3.2 中增加了对GEO类型的支持。GEO，Geographic，地理信息的缩写。该类型，就是元素的2维坐标，在地图上就是经纬度。redis基于该类型，提供了经纬度设置，查询，范围查询，距离查询，经纬度Hash等常见操作。</p>
<h5 id="命令-1"><a href="#命令-1" class="headerlink" title="命令"></a>命令</h5><h6 id="1、geoadd"><a href="#1、geoadd" class="headerlink" title="1、geoadd"></a>1、geoadd</h6><div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">geoadd &lt;key&gt; &lt;longitude&gt; &lt;latitude&gt; &lt;member&gt; [longitude latitude member...]   <span class="params">#</span>添加地理位置（经度，纬度，名称）</span><br></pre></td></tr></table></figure></div>

<p>例： geoadd china:city 121.47 31.23 shanghai</p>
<h6 id="2、geopos"><a href="#2、geopos" class="headerlink" title="2、geopos"></a>2、geopos</h6><div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">geopos  &lt;key&gt;&lt;member&gt; [member...] </span><br><span class="line">获得指定地区的坐标值</span><br></pre></td></tr></table></figure></div>

<p>例： geopos chian:city shanghai</p>
<h6 id="3、geodist"><a href="#3、geodist" class="headerlink" title="3、geodist"></a>3、geodist</h6><div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">geodist&lt;key&gt;&lt;member1&gt;&lt;member2&gt;  [m|km|ft|mi]  </span><br><span class="line">获取两个位置之间的直线距离</span><br></pre></td></tr></table></figure></div>

<p>例： geodist china:city beijing shanghai km</p>
<h6 id="4、georadius"><a href="#4、georadius" class="headerlink" title="4、georadius"></a>4、georadius</h6><div class="highlight-container" data-rel="Tex"><figure class="iseeu highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">georadius&lt;key&gt;&lt;longitude&gt;&lt;latitude&gt;radius  m|km|ft|mi   </span><br><span class="line">以给定的经纬度为中心，找出某一半径内的元素</span><br></pre></td></tr></table></figure></div>

<p>例： georadius china:city 110 30 1000 km</p>
<h3 id="7-Jedis（Java程序操作Redis的工具）"><a href="#7-Jedis（Java程序操作Redis的工具）" class="headerlink" title="7.Jedis（Java程序操作Redis的工具）"></a>7.Jedis（Java程序操作Redis的工具）</h3><h4 id="7-1导入Jedis依赖坐标"><a href="#7-1导入Jedis依赖坐标" class="headerlink" title="7.1导入Jedis依赖坐标"></a>7.1导入Jedis依赖坐标</h4><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div>



<h3 id="8-三种写回策略"><a href="#8-三种写回策略" class="headerlink" title="8.三种写回策略"></a>8.三种写回策略</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230723205520677.png"
                      alt="image-20230723205520677"
                ></p>
<p>配置文件APPEND ONLY MODE模块</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230727100757088.png"
                      alt="image-20230727100757088"
                ></p>
<h3 id="9-AOF总结"><a href="#9-AOF总结" class="headerlink" title="9 AOF总结"></a>9 AOF总结</h3><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230727100833116.png"
                      alt="image-20230727100833116"
                ></p>
<h4 id="数据恢复顺序和加载流程"><a href="#数据恢复顺序和加载流程" class="headerlink" title="数据恢复顺序和加载流程"></a>数据恢复顺序和加载流程</h4><p>aof的优先级高于rdb，如若aof开启，再启动redis的时候使用aof，默认是rdb。两者可以同时存在。</p>
<p>因为在通常情况下AoF文件保存的数据集要比RDB文件保存的数据集要完整.</p>
<p>aof采用文本形式存储，rdb采用二进制的形式存储</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230727101206453.png"
                     
                ></p>
<h4 id="一般采用AOF-RDB混合方式"><a href="#一般采用AOF-RDB混合方式" class="headerlink" title="一般采用AOF+RDB混合方式"></a><strong>一般采用AOF+RDB混合方式</strong></h4><p>结合了RDB和AOF的优点，既能快速加载又能避免丢失过多的数H。</p>
<p>1开启混合方式设置<br>设置aof-use-rdb-preamble的值为yes  yes表示开启，设置为no表示禁用<br>2 RDB+AOF的混合方式———&gt;结论:RDB镜像做全量持久化，AOF做增量持久化<br>先使用RDB进行快照存储，然后使用AOF持人化记录所有的写操作，当重写策略满足或手动触发重写的时候，将最新的数据存储为新的RDB记录</p>
<h4 id="同时关闭AOF-RDB"><a href="#同时关闭AOF-RDB" class="headerlink" title="同时关闭AOF+RDB"></a>同时关闭AOF+RDB</h4><ul>
<li><p>save “”</p>
<ul>
<li>禁用rdb</li>
<li>禁用rdb持久化模式下，我们仍然可以使用命令save、bgsave生成rdb文件</li>
</ul>
</li>
<li><p>appendonly no</p>
<ul>
<li>禁用aof</li>
<li>禁用aof持久化模式下，我们仍然可以使用命令bgrewriteaof生成aof文件</li>
</ul>
</li>
</ul>
<h2 id="二、Redis事务"><a href="#二、Redis事务" class="headerlink" title="二、Redis事务"></a>二、Redis事务</h2><h4 id="2-1-Redis事务VS数据库事务"><a href="#2-1-Redis事务VS数据库事务" class="headerlink" title="2.1 Redis事务VS数据库事务"></a>2.1 Redis事务VS数据库事务</h4><p>数据库事务：在一个库中的执行sql要么都成功，要么都失败</p>
<p>redis事务：一个队列中，一次性、顺序性、排他性的执行一系列命令</p>
<table>
<thead>
<tr>
<th>单独的隔离操作</th>
<th>Redis的事务仅仅是保证事务里的操作会被连续独占的执行，redis命令执行是线程架构，在执行完事务内所有指令前是不可能再去同时执行其他客户端的请求的</th>
</tr>
</thead>
<tbody><tr>
<td>没有隔离级别的概念</td>
<td>因为事务提交前任何指令都不会被实际执行，也就不存在”事务内的查询要看到事务里的更新，在事务外查询不能看到”这种问题了</td>
</tr>
<tr>
<td>不保证原子性</td>
<td>Redis的事务不保证原子性，也就是不保证所有指令同时成功或同时失败，只有决定是否开始执行全部指令的能力，没有执行到一半进行回滚的能力</td>
</tr>
<tr>
<td>排它性</td>
<td>Redis会保证一个事务内的命令依次执行，而不会被其它命令插入</td>
</tr>
</tbody></table>
<p>ACID  原子 持久 隔离 一致</p>
<h4 id="2-2-Redis事务命令"><a href="#2-2-Redis事务命令" class="headerlink" title="2.2 Redis事务命令"></a>2.2 Redis事务命令</h4><p>下表列出了redis事务的相关命令</p>
<table>
<thead>
<tr>
<th>序号</th>
<th align="left">命令及描述</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td align="left">DISCARD   取消事务，放弃执行事务块内的所有命令。</td>
</tr>
<tr>
<td>2</td>
<td align="left">EXEC  执行所有事务块内的命令。</td>
</tr>
<tr>
<td>3</td>
<td align="left">MULTI   标记—个事务块的开始。</td>
</tr>
<tr>
<td>4</td>
<td align="left">UNWATCH   取消WATCH命令对所有key的监视。</td>
</tr>
<tr>
<td>5</td>
<td align="left">WATCH key [key …]    监视一个(或多个)key，如果在事务执行之前这个(或这些) key 被其他命令所改动，那么事务将被打断。</td>
</tr>
</tbody></table>
<p>case1 正常执行：</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">MULTI</span><br><span class="line">set k1 v1</span><br><span class="line">set k2 v2</span><br><span class="line">set k3 v3INCR count</span><br><span class="line">EXEC</span><br><span class="line">get k3</span><br></pre></td></tr></table></figure></div>

<p>case2 放弃事务：</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MULTI</span><br><span class="line">set k1 v11</span><br><span class="line">set k2 v22</span><br><span class="line">INCR count</span><br><span class="line">DISCARD</span><br><span class="line">get count</span><br><span class="line">get k2</span><br></pre></td></tr></table></figure></div>

<p>case3 全体连坐	—个语法出错，全体连坐。如果任何一个命令语法有错.Redis会直接返回错误，所有的命令都不会执行</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MULTI</span><br><span class="line">set k1 v111</span><br><span class="line">set k2 v222</span><br><span class="line">set k3</span><br><span class="line">EXEC</span><br></pre></td></tr></table></figure></div>

<p>case4 冤头债主</p>
<p>Redis不提供事务回滚的功能，开发者必须在事务执行出错后，自行恢复数据库状态<br><strong>What about rollbacks?</strong><br>Redis does not support rollbacks of transactions since supporting rollbacks wouldhave a significant impacon the simplicity and performance of Redis.</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MULTI</span><br><span class="line">set k1 v111</span><br><span class="line">set k2 v222</span><br><span class="line">INCR count</span><br><span class="line">INCR email</span><br><span class="line">set k3 v333</span><br><span class="line">EXEC</span><br></pre></td></tr></table></figure></div>

<p>case5  watch监控 采用乐观锁</p>
<ul>
<li><p>悲观锁(Pessimistic Lock)，顾名思义，就是很悲观，每次去拿数据的时候都认为别人会修改,<br>所以每次在拿数据的时候都会上锁，这样别人想拿这个数据就会block直到它拿到锁。</p>
</li>
<li><p>乐观锁(Optimistic Lock)，顾名思义，就是很乐观，每次去拿数据的时候都认为别人不会修改，<strong>所以不会上锁</strong>，但是在更新会时候会判断一下在此期间别人有没有去更新这个数据。</p>
</li>
</ul>
<p><strong>乐观锁策略:提交版本必须大于记录当前版本才能执行更新</strong></p>
<p>watch</p>
<p>初始化k1和balance两个key,先监控再开启multi，保证两key变动在同一个事务内</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">set k1 abc</span><br><span class="line">set balance 100</span><br><span class="line">get k1</span><br><span class="line">get balance</span><br><span class="line">WATCH balance</span><br><span class="line"></span><br><span class="line">MULTI</span><br><span class="line">set k1 abc2</span><br><span class="line">set balance 110</span><br><span class="line">get k1</span><br><span class="line">get balance</span><br><span class="line">EXEC</span><br></pre></td></tr></table></figure></div>

<p>unwatch</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230727110954814.png"
                      alt="image-20230727110954814"
                ></p>
<p>一旦执行了exec之前加的监控锁都会被取消掉了<br>当客户端连接去失的时候(比如退出链接)，所有东西都会被取消监视</p>
<h4 id="2-3-总结"><a href="#2-3-总结" class="headerlink" title="2.3 总结"></a>2.3 总结</h4><p>**开启:**以MULTI开始一个事务<br><strong>入队</strong>:将多个命令入队到事务中，接到这些命令并不会立即执行，而是放到等待执行的事务队列里面<br><strong>执行</strong>:由EXEC命令触发事务</p>
<h2 id="三、管道"><a href="#三、管道" class="headerlink" title="三、管道"></a>三、管道</h2><p>面试题  如何优化频繁命令往返造成的性能瓶颈?</p>
<p>管道(pipeline)可以一次性发送多条命令给服务端，服务端依次处理完完毕后，通过一条响应一次性将结果返回，通过减少客户端与redis的通信次数来实现降低往返延时时间。pipeline实现的原理是队列，先进先出特性就保证数据的顺序性。</p>
<p>批处理命令变种优化措施，类似Redis的原生批命令（mset mget）</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@zzyy myredis]# cat cmd.txt</span><br><span class="line">[root@zzyy myredis] # cat cmd.txt | redis- cli -a 111111 -- pipe</span><br><span class="line">warning: Using a password with &#x27;- a&#x27; or &#x27;-u&#x27; option on the command line interf</span><br><span class="line">All data transferred. Waiting for the last reply.. .Last reply received from server.</span><br><span class="line">errors: 0, replies: 5</span><br></pre></td></tr></table></figure></div>

<h4 id="小总结："><a href="#小总结：" class="headerlink" title="小总结："></a>小总结：</h4><ul>
<li>Pipeline与原生批量命令对比<ul>
<li>原生批量命令是原子性(例如:mset, mget)，<strong>pipeline是非原子性</strong></li>
<li>原生批量命令一次只能执行一种命令，pipeline支持批量执行不同命令</li>
<li>原生批命令是服务端实现，而pipeline需要服务端与客户端共同完成</li>
</ul>
</li>
<li>Pipeline与事务对比<ul>
<li>事务具有原子性，管道不具有原子性</li>
<li>管道一次性将多条命令发送到服务器，事务是一条一条的发，事务只有在接收到exec命令后才执行，管道不会</li>
<li>执行事务时会阻塞其他命令的执行，而执行管道中的命令时不会</li>
</ul>
</li>
<li>使用Pipeline注意事项<ul>
<li>pipeline缓冲的指令只是会依次执行，不保证原子性，如果执行中指令发生异常，将会继续执行后续的指令</li>
<li>使用pipeline组装的命令个数不能太多，不然数据量过大客户端阻塞的时间可能过久，同时服务端此时也被迫回复一个队列答复一个队列答复，占用很多内存</li>
</ul>
</li>
</ul>
<h2 id="四-发布订阅"><a href="#四-发布订阅" class="headerlink" title="四 发布订阅"></a>四 发布订阅</h2><h3 id="1-定义"><a href="#1-定义" class="headerlink" title="1  定义"></a>1  定义</h3><p>是一种消息通信模式:发送者(PUBLISH)发送消息，订阅者(SUBSCRIBE)接收消息，可以实现进程间的消息传递</p>
<p>Redis可以实现消息中间件MQ的功能，通过发布订阅实现消息的引导和分流。</p>
<h3 id="2-常用命令"><a href="#2-常用命令" class="headerlink" title="2 常用命令"></a>2 常用命令</h3><table>
<thead>
<tr>
<th>序号</th>
<th>命令及描述</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>PSUBSCRIBE pattern [pattern …]   订阅一个或多个符合给定模式的频道。</td>
</tr>
<tr>
<td>2</td>
<td>PUBSUB subcommand [argument [argument …]]    查看订阅与发布系统状态。</td>
</tr>
<tr>
<td>3</td>
<td>PUBLISH channel message     将信息发送到指定的频道。</td>
</tr>
<tr>
<td>4</td>
<td>PUNSUBSCRIBE[pattern [pattern ..]]     退订所有给定模式的频道。</td>
</tr>
<tr>
<td>5</td>
<td>SUBSCRIBE channel [channel …]       订阅给定的一个或多个频道的信息。</td>
</tr>
<tr>
<td>6</td>
<td>UNSUBSCRIBE[channel [channel …]]    指退订给定的频道。</td>
</tr>
</tbody></table>
<p>开启3个客户端，演示客户端A、B订阅消息，客户端C发布消息</p>
<p>-演示批量订阅和发布圃<br>取消订阅圃</p>
<h3 id="3-小总结"><a href="#3-小总结" class="headerlink" title="3 小总结"></a>3 小总结</h3><p>Redis可以实现消息中间件MQ的功能，通过发布订阅实现消息的引导和分流。</p>
<p>缺点：</p>
<ol>
<li><p>发布的消息在Redis系统中不能持久化，因此，必须先执行订阅，再等待消息发布。如果先发布了消息，那么该消息由于没有订阅者，消息将被直接丢弃。</p>
</li>
<li><p>消息只管发送对于发布者而言消息是即发即失的，不管接收，也没有ACK机制，无法保证消息的消费成功。</p>
</li>
<li><p>以上的缺点导致Redis的Pub&#x2F;Sub模式就像个小玩具，在生产环境中几乎无用武之地<br>为此Redis5.0版本新增了Stream数据结构，不但支持多播，还支持数据持久化，相比Pub&#x2F;Sub更加的强大</p>
</li>
</ol>
<h2 id="五-复制-（replica）"><a href="#五-复制-（replica）" class="headerlink" title="五 复制 （replica）"></a>五 复制 （replica）</h2><h3 id="1-定义-1"><a href="#1-定义-1" class="headerlink" title="1 定义"></a>1 定义</h3><p>就是主从复制，master以写为主，Slave以读为主  当master数据变化的时候，自动将新的数据异步同步到其它slave数据库</p>
<h3 id="2-能做什么"><a href="#2-能做什么" class="headerlink" title="2 能做什么"></a>2 能做什么</h3><ul>
<li>读写分离</li>
<li>数据备份</li>
<li>容灾恢复</li>
<li>水平扩容支撑高并发</li>
</ul>
<p>master如果配置了requirepass参数，需要密码登陆</p>
<p>那么slave就要配置masterauth来设置校验密码，否则的话master会拒绝slave的访问请求</p>
<h3 id="3-复制原理和工作流程"><a href="#3-复制原理和工作流程" class="headerlink" title="3 复制原理和工作流程"></a>3 复制原理和工作流程</h3><ul>
<li><p>slave启动，同步初请</p>
<ul>
<li>slave启动成功连接到master后会发送一个sync命令</li>
<li>slave首次全新连接master,一次完全同步（全量复制)将被自动执行，slave自身原有数据会被master数据覆盖</li>
</ul>
</li>
<li><p>首次连接，全量复制</p>
</li>
<li><p>心跳持续，保持通信</p>
</li>
<li><p>进入平稳，增量复制</p>
</li>
<li><p>从机下线，重连续传</p>
<p>master会检查backlog里面的offset，master和slave都会保存一个复制的offset还有一masterId,offset是保存在backlog中的。Master只会把已经复制的offset后面的数据复制给Slave，类似断点续传</p>
</li>
</ul>
<h3 id="4-复制的缺点"><a href="#4-复制的缺点" class="headerlink" title="4 复制的缺点"></a>4 复制的缺点</h3><h4 id="复制延时，信号衰减"><a href="#复制延时，信号衰减" class="headerlink" title="复制延时，信号衰减"></a>复制延时，信号衰减</h4><p>由于所有的写操作都是先在Master上操作，然后同步更新到Slave 上，所以从Master同步到Slave机器有一定的延迟，当系统很繁忙的时候，延迟问题会更加严重，Slave机器数量的增加也会使这个问题更加严重。</p>
<h4 id="master挂了怎么办"><a href="#master挂了怎么办" class="headerlink" title="master挂了怎么办"></a>master挂了怎么办</h4><p>默认情况下，不会在slave节点中自动重选一个master</p>
<p>那每次都要人工干预?  无人值守安装变成刚需</p>
<h2 id="六-哨兵（sentinel）"><a href="#六-哨兵（sentinel）" class="headerlink" title="六 哨兵（sentinel）"></a>六 哨兵（sentinel）</h2><h3 id="1-哨兵的作用"><a href="#1-哨兵的作用" class="headerlink" title="1 哨兵的作用"></a>1 哨兵的作用</h3><p>1、监控redis运行状态，包括master和slave<br>2、当master down机，能自动将slave切换成新master</p>
<h3 id="2-哨兵模式"><a href="#2-哨兵模式" class="headerlink" title="2 哨兵模式"></a>2 哨兵模式</h3><p>3个哨兵     自动监控和维护集群，不存放数据，只是吹哨人<br>1主2从       用于数据读取和存放</p>
<ol>
<li>&#x2F;myredis目录下新建或者拷贝sentinel.conf文件，名字绝不能错</li>
<li>先看看&#x2F;opt目录下默认的sentinel.conf文件的内容</li>
<li>重点参数项说明</li>
<li>本次案例哨兵sentinel文件通用配置</li>
<li>先启动一主二从3个redis实例，测试正常的主从复制<br>&#x3D;&#x3D;&#x3D;&#x3D;以下是哨兵内容部分&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</li>
<li>再启动3个哨兵，完成监控</li>
<li>启动3个哨兵监控后再测试一次主从复制 ———–岁月静好一切OK</li>
<li>原有的master挂了</li>
<li>对比配置文件</li>
</ol>
<h3 id="3-哨兵运行流程和选举原理"><a href="#3-哨兵运行流程和选举原理" class="headerlink" title="3 哨兵运行流程和选举原理"></a>3 哨兵运行流程和选举原理</h3><p>当一个主从配置中的master失效之后，sentinel可以选举出一个新的master<br>用于自动接替原master的工作，主从配置中的其他redis服务器自动指向新的master同步数据。一般建议sentinel采取奇数台，防止某一台sentinel无法连接到master导致误切换</p>
<ol>
<li>三个哨兵监控一主二从，正常运行中</li>
<li>SDown主观下线(Subjectively Down)<ul>
<li>SDOWN(主观不可用)是<strong>单个sentinel自己主观上</strong>检测到的关于master的状态，从sentinel的角度来看，如果发送了PING心跳后，在一定时间内没有收到合法的回复，就达到了SDOWN的条件。</li>
<li>sentinel配置文件中的down-after-milliseconds设置了判断主观下线的时间长度</li>
</ul>
</li>
<li>ODown客观下线(Objectively uow）<ul>
<li>ODOWN需要一定数量的sentinel，<strong>多个哨兵达成一致意见</strong>才能认为一个master客观上已经宕掉</li>
</ul>
</li>
<li>选举出领导者哨兵(哨兵中选出兵王)<ul>
<li>当主节点被判断客观下线以后，各个哨兵节点会进行协商，先选举出一个领导者哨兵节点（(兵王)并由该领导者节点，也即被选举出的兵王进行failover(故障迁移)</li>
</ul>
</li>
<li>由兵王开始推动故障切换流程并选出一个新master<ul>
<li>新主登基   某个Slave被选中成为新Master</li>
<li>群臣俯首</li>
<li>旧主拜服  之前的旧master也会变成新master的从节点</li>
</ul>
</li>
</ol>
<h3 id="4-哨兵使用建议"><a href="#4-哨兵使用建议" class="headerlink" title="4 哨兵使用建议"></a>4 哨兵使用建议</h3><ol>
<li>哨兵节点的数量应为多个，哨兵本身应该集群，保证高可用</li>
<li>哨兵节点的数量应该是奇数</li>
<li>各个哨兵节点的配置应一致</li>
<li>如果哨兵节点部署在Docker等容器里面，尤其要注意端口的正确映射</li>
<li>哨兵集群＋主从复制，并不能保证数据零丢失   —–&gt;  承上启下引出集群</li>
</ol>
<h2 id="七-集群"><a href="#七-集群" class="headerlink" title="七 集群"></a>七 集群</h2><h3 id="1-定义-2"><a href="#1-定义-2" class="headerlink" title="1 定义"></a>1 定义</h3><p>由于数据量过大，单个Master复制集难以承担，因此需要对多个复制集进行集群，形成水平扩展每个复制集只负责存储整个数据集的一部分，这就是Redis的集群，其作用是提供在多个Redis节点间共享数据的程序集。<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="D:\源码\笔记\images\image-20230801142317572.png"
                      alt="image-20230801142317572"
                ></p>
<p>Redis集群是一个提供在多个Redis节点间共享数据的程序集Redis集群可以支持多个Master</p>
<h3 id="2-集群能干什么"><a href="#2-集群能干什么" class="headerlink" title="2 集群能干什么"></a>2 集群能干什么</h3><ul>
<li>Redis集群支持多个Master，每个Master又可以挂载多个Slave</li>
<li>由于Cluster自带Sentinel的故障转移机制，内置了高可用的支持，<strong>无需再去使用哨兵功能</strong></li>
<li>客户端与Redis的节点连接，不再需要连接集群中所有的节点，只需要任意连接集群中的一个可用节点即可</li>
<li><strong>槽位slot</strong>负责分配到各个物理服务节点，由对应的集群来负责维护节点、插槽和数据之间的关系</li>
</ul>
<h3 id="3-集群算法-分片-槽位slot"><a href="#3-集群算法-分片-槽位slot" class="headerlink" title="3 集群算法-分片-槽位slot"></a>3 集群算法-分片-槽位slot</h3><ul>
<li><p>redis集群的槽位slot</p>
</li>
<li><p>redis集群的分片</p>
</li>
<li><p>槽位映射，一般有三种解决方式</p>
<ul>
<li>哈希取余分区</li>
<li>一致性哈希算法分区</li>
<li>哈希槽分区</li>
</ul>
<p><strong>槽位(哈希槽)最大数16384  redis集群1000</strong></p>
<p>提问：为什么最大16384   2^14？</p>
<p>(1)如果槽位为65536，发送心跳信息的消息头达8k，发送的心跳包过于庞大。</p>
<p>(2)redis的集群主节点数量基本不可能超过1000个。<br>(3)槽位越小，节点少的情况下，压缩比高，容易传输</p>
<p>Redis集群不保证强一致性，这意味着在特定的条件下，Redis集群可能会丢掉一些被系统收到的写入请求命令</p>
</li>
</ul>
<h3 id="4-集群环境案例步骤"><a href="#4-集群环境案例步骤" class="headerlink" title="4 集群环境案例步骤"></a>4 集群环境案例步骤</h3><ol>
<li>找3台真实虚拟机，各自新建</li>
<li>新建6个独立的redis实例服务<ol>
<li>通过redis-cli命令为6台机器构建集群关系</li>
</ol>
</li>
<li>链接进入6381作为切入点，查看并检验集群状态</li>
</ol>
<p>扩容master </p>
<p> redis-cli -a 密码  –cluster add-node ip:新slave端口 ip:新master端口  –cluster-slave   	–cluster-master-id    新主机节点ID</p>
<p>缩容master </p>
<p> redis-cli -a 密码  –cluster del-node ip:slave端口  新主机节点ID</p>
<h3 id="5集群常用操作命令和CRC16算法分析"><a href="#5集群常用操作命令和CRC16算法分析" class="headerlink" title="5集群常用操作命令和CRC16算法分析"></a>5集群常用操作命令和CRC16算法分析</h3><ul>
<li><p>不在同一个slot槽位下的多键操作支持不好，通识占位符登场</p>
<p>mset  k1{z} z1  k2{z}  z2  k3{z}  z3    mget k1 k2 k3</p>
</li>
<li><p>Redis集群有16384个哈希槽，每个key通过CRC16校验后对16384取模来决定放置哪个槽。集群的每个节点负责一部分hash槽</p>
</li>
<li><p>常用命令</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">集群是否完整才能对外提供服务-------&gt;  cluster-require-full-coverage</span><br><span class="line"></span><br><span class="line">CLUSTER COUNTKEYSINSLOT  槽位数字编号</span><br><span class="line">1，该槽位被占用       0，该槽位没占用</span><br><span class="line"></span><br><span class="line">CLUSTER NODES</span><br><span class="line">CLUSTER KEYSLOT 键名称  该键应该存在哪个槽位上</span><br></pre></td></tr></table></figure></div></li>
</ul>
<h2 id="八-Spring-Boot整合redis"><a href="#八-Spring-Boot整合redis" class="headerlink" title="八 Spring Boot整合redis"></a>八 Spring Boot整合redis</h2><h3 id="1总体概述"><a href="#1总体概述" class="headerlink" title="1总体概述"></a>1总体概述</h3><p>jedis-lettuce-RedisTemplate三者的联系</p>
<h3 id="2-本地Java连接Redis常见问题，小白注意"><a href="#2-本地Java连接Redis常见问题，小白注意" class="headerlink" title="2 本地Java连接Redis常见问题，小白注意"></a>2 本地Java连接Redis常见问题，小白注意</h3><p>(1)bind配置请注释掉保护模式设罚为no<br>(2)Linux系统的防火墙设置<br>(3)redis服务器的IP地址和密码是否正确</p>
<p>(3)忘记写访问redis的服务端口号和auth密码</p>
<p>(5)无脑粘贴脑图笔记……o(TT)o</p>
<h3 id="3-集成Jedis"><a href="#3-集成Jedis" class="headerlink" title="3 集成Jedis"></a>3 集成Jedis</h3><p>Jedis Client是Redis官网推荐的一个面向java客户端，库文件实现了对各类API进行封装调用</p>
<h3 id="4-集成lettuce"><a href="#4-集成lettuce" class="headerlink" title="4 集成lettuce"></a>4 集成lettuce</h3><p>是一个Redis的Java驱动包，	</p>
<ol>
<li>集成RedisTemplate-推荐使用</li>
</ol>
<h3 id="5-集成RedisTemplate-推荐使用"><a href="#5-集成RedisTemplate-推荐使用" class="headerlink" title="5 集成RedisTemplate-推荐使用"></a>5 集成RedisTemplate-推荐使用</h3><ul>
<li><p>连接单机 </p>
</li>
<li><p>连接集群</p>
</li>
</ul>

            </div>

            
                <div class="post-copyright-info">
                    <div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> Redis</li>
        <li><strong>Author:</strong> 清风煮酒</li>
        <li><strong>Created at:</strong> 2023-04-03 20:09:56</li>
        
            <li>
                <strong>Updated at:</strong> 2023-08-24 16:07:09
            </li>
        
        <li>
            <strong>Link:</strong> https://redefine.ohevan.com/2023/04/03/Redis/
        </li>
        <li>
            <strong>License:</strong> This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a>.
        </li>
    </ul>
</div>

                </div>
            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/Redis/">#Redis</a>&nbsp;
                        </li>
                    
                </ul>
            

            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                            rel="prev"
                            href="/2023/08/23/js%E7%9F%A5%E8%AF%86%E7%82%B9/"
                            >
                                <span class="left arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-left"></i>
                                </span>
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">js进阶知识点</span>
                                    <span class="post-nav-item">Prev posts</span>
                                </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                            rel="next"
                            href="/2023/03/21/springcloud/"
                            >
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">spring cloud</span>
                                    <span class="post-nav-item">Next posts</span>
                                </span>
                                <span class="right arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-right"></i>
                                </span>
                            </a>
                        </div>
                    
                </div>
            


            
                <div class="comment-container">
                    <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fa-solid fa-comments"></i>&nbsp;Comments
    </div>
    

        
            
 
    <div id="waline"></div>
    <script type="module"  data-pjax>
        import { init } from 'https://evan.beee.top/js/waline.mjs';

        function loadWaline() {
            init({
                el: '#waline',
                serverURL: 'https://example.example.com',
                lang: 'zh-CN',
                dark: 'body[class~="dark-mode"]',
                requiredMeta: ['nick','mail'], // cannot customize by theme config, change it yourself
            });
        }

        if ('true') {
            const loadWalineTimeout = setTimeout(() => {
                loadWaline();
                clearTimeout(loadWalineTimeout);
            }, 1000);
        } else {
            window.addEventListener('DOMContentLoaded', loadWaline);
        }
        
    </script>



        
    
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">On this page</div>
        <div class="page-title">Redis</div>
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-redis%E7%AE%80%E4%BB%8B"><span class="nav-text">1.redis简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#redis%E7%9A%84%E5%8E%9F%E5%AD%90%E6%80%A7"><span class="nav-text">redis的原子性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%8C%E5%BC%8F%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">行式存储数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%97%E5%BC%8F%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">列式存储数据库</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94%E5%A4%A7%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE"><span class="nav-text">五大基本数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E6%96%B0%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-text">6.新数据类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-Jedis%EF%BC%88Java%E7%A8%8B%E5%BA%8F%E6%93%8D%E4%BD%9CRedis%E7%9A%84%E5%B7%A5%E5%85%B7%EF%BC%89"><span class="nav-text">7.Jedis（Java程序操作Redis的工具）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-%E4%B8%89%E7%A7%8D%E5%86%99%E5%9B%9E%E7%AD%96%E7%95%A5"><span class="nav-text">8.三种写回策略</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-AOF%E6%80%BB%E7%BB%93"><span class="nav-text">9 AOF总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81Redis%E4%BA%8B%E5%8A%A1"><span class="nav-text">二、Redis事务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E7%AE%A1%E9%81%93"><span class="nav-text">三、管道</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B-%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85"><span class="nav-text">四 发布订阅</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%AE%9A%E4%B9%89"><span class="nav-text">1  定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-text">2 常用命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E5%B0%8F%E6%80%BB%E7%BB%93"><span class="nav-text">3 小总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94-%E5%A4%8D%E5%88%B6-%EF%BC%88replica%EF%BC%89"><span class="nav-text">五 复制 （replica）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%AE%9A%E4%B9%89-1"><span class="nav-text">1 定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E8%83%BD%E5%81%9A%E4%BB%80%E4%B9%88"><span class="nav-text">2 能做什么</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86%E5%92%8C%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="nav-text">3 复制原理和工作流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E5%A4%8D%E5%88%B6%E7%9A%84%E7%BC%BA%E7%82%B9"><span class="nav-text">4 复制的缺点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AD-%E5%93%A8%E5%85%B5%EF%BC%88sentinel%EF%BC%89"><span class="nav-text">六 哨兵（sentinel）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%93%A8%E5%85%B5%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-text">1 哨兵的作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F"><span class="nav-text">2 哨兵模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E5%93%A8%E5%85%B5%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B%E5%92%8C%E9%80%89%E4%B8%BE%E5%8E%9F%E7%90%86"><span class="nav-text">3 哨兵运行流程和选举原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E5%93%A8%E5%85%B5%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE"><span class="nav-text">4 哨兵使用建议</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%83-%E9%9B%86%E7%BE%A4"><span class="nav-text">七 集群</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%AE%9A%E4%B9%89-2"><span class="nav-text">1 定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%9B%86%E7%BE%A4%E8%83%BD%E5%B9%B2%E4%BB%80%E4%B9%88"><span class="nav-text">2 集群能干什么</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%9B%86%E7%BE%A4%E7%AE%97%E6%B3%95-%E5%88%86%E7%89%87-%E6%A7%BD%E4%BD%8Dslot"><span class="nav-text">3 集群算法-分片-槽位slot</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%A1%88%E4%BE%8B%E6%AD%A5%E9%AA%A4"><span class="nav-text">4 集群环境案例步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5%E9%9B%86%E7%BE%A4%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4%E5%92%8CCRC16%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90"><span class="nav-text">5集群常用操作命令和CRC16算法分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AB-Spring-Boot%E6%95%B4%E5%90%88redis"><span class="nav-text">八 Spring Boot整合redis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%E6%80%BB%E4%BD%93%E6%A6%82%E8%BF%B0"><span class="nav-text">1总体概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%9C%AC%E5%9C%B0Java%E8%BF%9E%E6%8E%A5Redis%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%EF%BC%8C%E5%B0%8F%E7%99%BD%E6%B3%A8%E6%84%8F"><span class="nav-text">2 本地Java连接Redis常见问题，小白注意</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%9B%86%E6%88%90Jedis"><span class="nav-text">3 集成Jedis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E9%9B%86%E6%88%90lettuce"><span class="nav-text">4 集成lettuce</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E9%9B%86%E6%88%90RedisTemplate-%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8"><span class="nav-text">5 集成RedisTemplate-推荐使用</span></a></li></ol>

    </div>
</div>
            </div>
        
    </div>
</div>


                

            </div>
            
            

        </div>

        <div class="main-content-footer">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info">
            &copy;
            
              <span>2022</span>
              -
            
            2023&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">清风煮酒</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv" class="busuanzi_container_site_uv">
                        VISITOR COUNT&nbsp;<span id="busuanzi_value_site_uv" class="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="busuanzi_container_site_pv">
                        TOTAL PAGE VIEWS&nbsp;<span id="busuanzi_value_site_pv" class="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            <span class="powered-by-container">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" href="https://hexo.io">Hexo</a></span>
                <br>
            <span class="theme-version-container">THEME&nbsp;<a class="theme-version" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.1.2</a>
        </div>
        
        
        
            <div id="start_div" style="display:none">
                2022/8/17 11:45:14
            </div>
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
        
            <script async data-pjax>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-expand-width flex-center">
            <i class="fa-regular fa-expand"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    


</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/layouts/navbarShrink.js"></script>

<script src="/js/tools/scrollTopBottom.js"></script>

<script src="/js/tools/lightDarkSwitch.js"></script>





    
<script src="/js/tools/codeBlock.js"></script>




    
<script src="/js/layouts/lazyload.js"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/layouts/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js"></script>







<div class="post-scripts pjax">
    
        
<script src="/js/tools/tocToggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/layouts/toc.js"></script>

<script src="/js/plugins/tabs.js"></script>

    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax',
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            Global.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            Global.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            Global.refresh();
        });
    });
</script>




</body>
</html>
